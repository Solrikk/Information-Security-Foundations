
# 1.1 Введение

---

[Веб-приложения](https://en.wikipedia.org/wiki/Web_application) — это интерактивные приложения, работающие в веб-браузерах. Веб-приложения обычно используют [клиент-серверную архитектуру](https://cio-wiki.org/wiki/Client_Server_Architecture) для работы и обработки взаимодействий. Обычно они имеют интерфейсные компоненты (т.е. интерфейс веб-сайта или то, что "видит пользователь"), которые работают на стороне клиента (браузер), и другие серверные компоненты (исходный код веб-приложения), которые работают на стороне сервера (внутренний сервер/базы данных).

Это позволяет организациям размещать мощные приложения с почти полным контролем в реальном времени над их дизайном и функциональностью, которые доступны по всему миру. Некоторые примеры типичных веб-приложений включают онлайн-почтовые службы, такие как `Gmail`, онлайн-магазины, такие как `Amazon`, и онлайн-текстовые редакторы, такие как `Google Docs`.

![Панель управления, показывающая 932 онлайн-игроков, 1032 захваченных машин, 622 решенных задачи и последние активности с целями Lame, Emdee five for life и Delivery.](https://academy.hackthebox.com/storage/modules/75/redesigned/htb-web-app_1.png)

Веб-приложения не являются прерогативой только крупных провайдеров, таких как Google или Microsoft, но могут быть разработаны любым веб-разработчиком и размещены в Интернете в любом из общих хостинговых сервисов, чтобы ими мог пользоваться любой пользователь в Интернете. Именно поэтому сегодня в Интернете существуют миллионы веб-приложений, с которыми ежедневно взаимодействуют миллиарды пользователей.

---

## Веб-приложения и веб-сайты

Раньше мы взаимодействовали с веб-сайтами, которые были статичными и не могли изменяться в реальном времени. Это означает, что традиционные веб-сайты были статически созданы для представления определенной информации, и эта информация не менялась при нашем взаимодействии. Чтобы изменить содержимое веб-сайта, соответствующую страницу должны были вручную отредактировать разработчики. Такие типы статических страниц не содержат функций и, следовательно, не производят изменений в реальном времени. Такой тип веб-сайта также известен как [Web 1.0](https://en.wikipedia.org/wiki/Web_2.0#Web_1.0).

![Сравнение веб-сайта и веб-приложения: Веб-сайт имеет статические страницы, одинаковые для всех; Веб-приложение имеет динамические, интерактивные страницы, разные для каждого пользователя.](https://academy.hackthebox.com/storage/modules/75/redesigned/website_vs_webapps.png)

С другой стороны, большинство веб-сайтов работают как веб-приложения, или [Web 2.0](https://en.wikipedia.org/wiki/Web_2.0), представляя динамический контент на основе взаимодействия с пользователем. Еще одно существенное отличие заключается в том, что веб-приложения полностью функциональны и могут выполнять различные функции для конечного пользователя, тогда как веб-сайты лишены такого функционала. Другие ключевые различия между традиционными веб-сайтами и веб-приложениями включают:

* Модульность
* Работа на любом размере дисплея
* Работа на любой платформе без оптимизации

---

## Веб-приложения и нативные приложения операционных систем

В отличие от нативных приложений операционных систем, веб-приложения независимы от платформы и могут работать в браузере на любой операционной системе. Эти веб-приложения не требуют установки на системе пользователя, поскольку они и их функциональность выполняются удаленно на удаленном сервере и, следовательно, не занимают места на жестком диске конечного пользователя.

Еще одно преимущество веб-приложений над нативными приложениями ОС — единство версий. Все пользователи, получающие доступ к веб-приложению, используют одну и ту же версию и одно и то же веб-приложение, которое может постоянно обновляться и модифицироваться без необходимости отправки обновлений каждому пользователю. Веб-приложения могут обновляться в одном месте (веб-сервер) без разработки различных сборок для каждой платформы, что значительно снижает затраты на обслуживание и поддержку, устраняя необходимость сообщать об изменениях каждому пользователю в отдельности.

С другой стороны, нативные приложения ОС имеют определенные преимущества перед веб-приложениями, в основном в скорости работы и возможности использовать нативные библиотеки операционной системы и локальное аппаратное обеспечение. Поскольку нативные приложения созданы для использования нативных библиотек ОС, они загружаются и взаимодействуют гораздо быстрее. Кроме того, нативные приложения обычно имеют больше возможностей, чем веб-приложения, так как они имеют более глубокую интеграцию с операционной системой и не ограничены только возможностями браузера.

В последнее время, однако, гибридные и прогрессивные веб-приложения становятся все более распространенными. Они используют современные фреймворки для запуска веб-приложений с использованием возможностей и ресурсов нативной ОС, делая их быстрее обычных веб-приложений и более функциональными.

---

## Распространение веб-приложений

Существует множество веб-приложений с открытым исходным кодом, используемых организациями по всему миру, которые можно настроить в соответствии с потребностями каждой организации. Некоторые распространенные веб-приложения с открытым исходным кодом включают:

* [WordPress](https://wordpress.com/)
* [OpenCart](https://www.opencart.com/)
* [Joomla](https://www.joomla.org/)

Существуют также проприетарные веб-приложения с "закрытым исходным кодом", которые обычно разрабатываются определенной организацией, а затем продаются другой организации или используются организациями по модели подписки. Некоторые распространенные веб-приложения с закрытым исходным кодом включают:

* [Wix](https://www.wix.com/)
* [Shopify](https://www.shopify.com/)
* [DotNetNuke](https://www.dnnsoftware.com/)

---

## Риски безопасности веб-приложений

Атаки на веб-приложения распространены и представляют проблему для большинства организаций, имеющих присутствие в Интернете, независимо от их размера. В конце концов, они обычно доступны из любой страны для каждого, у кого есть подключение к Интернету и веб-браузер, и обычно предлагают обширную поверхность для атак. Существует множество автоматизированных инструментов для сканирования и атаки веб-приложений, которые в неправильных руках могут нанести значительный ущерб. По мере того, как веб-приложения становятся более сложными и продвинутыми, увеличивается возможность включения критических уязвимостей в их дизайн.

Успешная атака на веб-приложение может привести к значительным потерям и серьезным перебоям в работе бизнеса. Поскольку веб-приложения работают на серверах, которые могут содержать другую конфиденциальную информацию и часто связаны с базами данных, содержащими конфиденциальные пользовательские или корпоративные данные, все эти данные могут быть скомпрометированы в случае успешной атаки на веб-сайт. Поэтому для любого бизнеса, использующего веб-приложения, критически важно должным образом тестировать эти приложения на наличие уязвимостей и оперативно исправлять их, одновременно проверяя, что исправление устраняет дефект и не приводит к случайным новым дефектам.

Тестирование на проникновение в веб-приложения — это все более важный навык для изучения. Любая организация, желающая защитить свои веб-приложения, доступные из Интернета (и внутренние), должна проводить частые тесты веб-приложений и внедрять безопасные практики кодирования на каждом этапе жизненного цикла разработки. Чтобы правильно тестировать веб-приложения на проникновение, нам необходимо понять, как они работают, как они разрабатываются и какие риски таятся на каждом уровне и компоненте приложения в зависимости от используемых технологий.

Мы всегда будем сталкиваться с различными веб-приложениями, которые спроектированы и настроены по-разному. Один из наиболее актуальных и широко используемых методов тестирования веб-приложений — [Руководство по тестированию безопасности веб-приложений OWASP](https://github.com/OWASP/wstg/tree/master/document/4-Web_Application_Security_Testing).

Одна из наиболее распространенных процедур — начать с анализа компонентов интерфейса веб-приложения, таких как `HTML`, `CSS` и `JavaScript` (также известных как "frontend trinity"), и попытаться найти уязвимости, такие как [Разглашение конфиденциальных данных](https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure) и [Межсайтовый скриптинг (XSS)](https://owasp.org/www-project-top-ten/2017/A7_2017-Cross-Site_Scripting_(XSS)). После тщательного тестирования всех компонентов интерфейса мы обычно рассматриваем основную функциональность веб-приложения и взаимодействие между браузером и веб-сервером, чтобы перечислить технологии, используемые веб-сервером, и искать эксплуатируемые недостатки. Обычно мы оцениваем веб-приложения как с неаутентифицированной, так и с аутентифицированной точки зрения (если приложение имеет функциональность входа в систему), чтобы максимизировать охват и рассмотреть каждый возможный сценарий атаки.

---

## Атака на веб-приложения

В наше время почти каждая компания, независимо от размера, имеет одно или несколько веб-приложений в своем внешнем периметре. Эти приложения могут быть чем угодно: от простых статических веб-сайтов до блогов, работающих на системах управления контентом (CMS), таких как `WordPress`, до сложных приложений с функциональностью регистрации/входа, поддерживающих различные роли пользователей от базовых пользователей до суперадминов. В наши дни не очень распространено найти внешне подключенный хост, непосредственно уязвимый для известного публичного эксплойта (такого как уязвимая служба или уязвимость Windows для удаленного выполнения кода (RCE)), хотя такое случается. Веб-приложения предоставляют обширную поверхность для атак, и их динамический характер означает, что они постоянно меняются (и часто упускаются из виду!). Относительно простое изменение кода может привести к катастрофической уязвимости или серии уязвимостей, которые могут быть объединены для получения доступа к конфиденциальным данным или удаленного выполнения кода на веб-сервере или других хостах в среде, таких как серверы баз данных.

Нередко можно найти дефекты, которые могут привести непосредственно к выполнению кода, например, форма загрузки файлов, позволяющая загружать вредоносный код, или уязвимость включения файлов, которую можно использовать для получения удаленного выполнения кода. Хорошо известная уязвимость, которая все еще весьма распространена в различных типах веб-приложений — это SQL-инъекция. Этот тип уязвимости возникает из-за небезопасной обработки ввода, предоставляемого пользователем. Он может привести к доступу к конфиденциальным данным, чтению/записи файлов на сервере базы данных и даже к удаленному выполнению кода.

Мы часто находим уязвимости SQL-инъекции в веб-приложениях, использующих Active Directory для аутентификации. Хотя обычно мы не можем использовать это для извлечения паролей (поскольку ими управляет Active Directory), мы часто можем извлечь большинство или все адреса электронной почты пользователей Active Directory, которые часто совпадают с их именами пользователей. Эти данные затем могут быть использованы для выполнения [атаки распыления паролей](https://us-cert.cisa.gov/ncas/current-activity/2019/08/08/acsc-releases-advisory-password-spraying-attacks) против веб-порталов, использующих Active Directory для аутентификации, таких как VPN или Microsoft Outlook Web Access/Microsoft O365. Успешное распыление паролей часто может привести к доступу к конфиденциальным данным, таким как электронная почта, или даже к непосредственному доступу в корпоративную сетевую среду.

Этот пример показывает ущерб, который может возникнуть из-за одной уязвимости веб-приложения, особенно при "цепочке" для извлечения данных из одного приложения, которые можно использовать для атаки на другие части внешней инфраструктуры компании. Профессионал в области информационной безопасности с широким кругозором должен иметь глубокое понимание веб-приложений и чувствовать себя так же комфортно при атаке на веб-приложения, как при проведении тестирования на проникновение в сеть и атаках на Active Directory. Тестер на проникновение с прочной основой в веб-приложениях часто может выделиться среди своих коллег и найти недостатки, которые другие могут упустить. Еще несколько примеров атак на веб-приложения в реальном мире и их влияние следующие:

| Недостаток | Сценарий реального мира |
| --- | --- |
| [SQL-инъекция](https://owasp.org/www-community/attacks/SQL_Injection) | Получение имен пользователей Active Directory и выполнение атаки распыления паролей против VPN или почтового портала. |
| [Включение файлов](https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/07-Input_Validation_Testing/11.1-Testing_for_Local_File_Inclusion) | Чтение исходного кода для поиска скрытой страницы или каталога, который предоставляет дополнительную функциональность, которую можно использовать для получения удаленного выполнения кода. |
| [Неограниченная загрузка файлов](https://owasp.org/www-community/vulnerabilities/Unrestricted_File_Upload) | Веб-приложение, которое позволяет пользователю загружать изображение профиля, разрешает загрузку файлов любого типа (не только изображений). Это можно использовать для получения полного контроля над сервером веб-приложения путем загрузки вредоносного кода. |
| [Небезопасное прямое указание объектов (IDOR)](https://cheatsheetseries.owasp.org/cheatsheets/Insecure_Direct_Object_Reference_Prevention_Cheat_Sheet.html) | При сочетании с такой уязвимостью, как нарушение контроля доступа, это часто можно использовать для доступа к файлам или функциональности другого пользователя. Примером может быть редактирование вашего профиля пользователя на странице такой как /user/701/edit-profile. Если мы сможем изменить `701` на `702`, мы сможем редактировать профиль другого пользователя! |
| [Нарушение контроля доступа](https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control) | Другим примером является приложение, которое позволяет пользователю зарегистрировать новую учетную запись. Если функциональность регистрации учетной записи спроектирована плохо, пользователь может выполнить повышение привилегий при регистрации. Рассмотрим запрос `POST` при регистрации нового пользователя, который отправляет данные `username=bjones&password=Welcome1&email=bjones@inlanefreight.local&roleid=3`. Что если мы сможем манипулировать параметром `roleid` и изменить его на `0` или `1`. Мы видели реальные приложения, где это было возможно, и было легко быстро зарегистрировать пользователя с правами администратора и получить доступ ко многим непреднамеренным функциям веб-приложения. |

Начните знакомиться с распространенными атаками на веб-приложения и их последствиями. Не беспокойтесь, если какие-либо из этих терминов кажутся вам незнакомыми на данный момент; они станут яснее по мере вашего продвижения и применения итеративного подхода к обучению.

Важно глубоко изучать веб-приложения и ознакомиться с тем, как они работают, и с множеством различных стеков приложений. Мы будем видеть атаки на веб-приложения неоднократно во время нашего пути в Академии, на основной платформе HTB и в оценках реальной жизни. Давайте погрузимся и изучим структуру/функции веб-приложений, чтобы стать более информированными атакующими, выделиться среди своих коллег и найти недостатки, которые другие могут упустить.
